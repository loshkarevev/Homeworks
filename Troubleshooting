1
Узнаем текущую запущенну операцию
db.currentOp()
Убиваем по opid
db.killOp()

Чтобы не было долгих запросов, нужно построить соответствующий индекс

2
Проблема в том, что закончилась оперативная память

3
Видимо ошибки начали возникать из-за увеличения нагрузки. В качестве решения можно:
Увеличить значение connect_timeout, interactive_timeout, wait_timeout
Добавить железа, построить индекс.

Еще возможно из-за сетевых проблем, тогда нужно увеличивать net_read_timeout (https://dev.mysql.com/doc/refman/5.7/en/error-lost-connection.html).
Также возможно нужно увеличить max_connections (https://www.opennet.ru/docs/RUS/sql_error/chap10.html).

4
Заканчивается оперативная память, чтобы не обрушить всю систему, ОС останавливает процесс, который съедает память.
Чтобы проблемы не было, нужно увеличить память на хосте или выставить ограничение в настройках PG, чтобы не использовалась вся память хоста.
